<!DOCTYPE html>
<html>
	<head>
		<title>Reactive.coffee demo</title>
		<script type="text/javascript" src="../build/reactive.js"></script>
		<script type="text/javascript">
			window.addEventListener('load', function(evt) {
				var formValue = EventStream.from_form_value(document.getElementById('foo'), 'keyup');

				var empty = formValue.map(function(v){return v.length == 0});
				// empty.log('isEmpty');
				var disabled = empty.map(function(e){return e ? 'disable' : ''});
				// disabled.log('disabled');
				disabled.bind_value(document.getElementById('send'), 'disabled');

				var windowTitle = formValue.map(function(v) { return v + (empty.value ? '' : ' | ') + 'Reactive Demo' });
				windowTitle.bind_value(document, 'title');

				var clicks = EventStream.from_event(document.getElementById('send'), 'click');
				var clickCounter = clicks.fold(0, function(x, evt) { return x+1 });

				clicks.log();

				clickCounter.bind_value(document.getElementById('clickcounter'), 'innerText');

			});
		</script>
	</head>
	<body>
			<input id="foo" type="text" value="foo"/>
			<button id="send">Send Message</button>
		<div id="clickcounter"></div>
	</body>
</html>
